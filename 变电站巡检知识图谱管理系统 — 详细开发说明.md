---

# 变电站巡检知识图谱管理系统 — 详细开发说明（Arco Design Pro 版本）

> **版本类型**：详细开发说明版
> **前端框架**：Vue 3 + Arco Design Pro
> **后端架构**：Node.js + Java
> **数据库**：MySQL + Neo4j
> **可视化**：ECharts + Cytoscape.js
> **最后更新**：2025-10

---

## 📘 目录

1. 项目概述
2. 系统总体设计
3. 功能设计（多角色）
4. 知识图谱模块设计
5. 数据库设计（MySQL）
6. 接口设计（REST + WebSocket）
7. 权限与安全设计
8. 前端实现（Vue3 + Arco Design Pro）
9. 后端实现（Node.js + Java）

---

## 1. 项目概述

### 1.1 项目背景

针对变电站巡检管理的痛点，构建一套**知识图谱驱动的巡检管理系统**，实现：

* 巡检设备与任务关系的图谱化；
* 设备异常与告警自动联动；
* 各角色多首页分权展示；
* 数据可视化分析与决策支持。

### 1.2 用户角色

| 角色    | 首页名称    | 职能        | 权限   |
| ----- | ------- | --------- | ---- |
| 系统管理员 | 综合管理仪表盘 | 系统与业务管理   | 全功能  |
| 巡检人员  | 我的工作台   | 任务执行、异常上报 | 任务权限 |
| 只读用户  | 运营状态总览  | 状态监控与分析   | 只读权限 |

---

## 2. 系统总体设计

### 2.1 技术架构概述

系统采用前后端分离架构：

| 层级    | 技术                      | 说明                     |
| ----- | ----------------------- | ---------------------- |
| 前端    | Vue 3 + Arco Design Pro | 界面交互、布局、图表与权限控制        |
| 中间层   | Node.js (Express/Koa)   | API 网关、鉴权、WebSocket 推送 |
| 后端    | Java (Spring Boot)      | 核心业务逻辑、任务调度、报表生成       |
| 数据存储  | MySQL + Neo4j           | 关系型业务数据 + 图谱结构化关系      |

### 2.2 模块划分

* 用户与权限模块
* 设备管理模块
* 巡检任务模块
* 告警管理模块
* 知识图谱可视化模块
* 报表与统计模块
* 系统监控模块

---

## 3. 功能设计（多角色）

### 3.1 系统管理员 — 综合管理仪表盘

#### 功能模块

* **系统状态面板**：显示在线用户、核心服务状态、数据库状态等
* **业务KPI面板**：设备总数、正常率、告警量、任务完成率
* **知识图谱概览**：展示全站设备拓扑关系
* **快速操作区**：新建设备 / 分配任务 / 用户管理
* **待办任务列表**：告警、审核、用户激活任务提示

#### Arco UI 实现建议

* 使用 `a-card` 展示指标信息
* `a-space` + `a-statistic` 实现 KPI 排版
* 图谱区使用自定义 `GraphCanvas.vue` 组件（内嵌 Cytoscape.js）
* 待办列表用 `a-list` + `a-badge` + `a-popover` 展示状态

#### 关键接口

* `GET /api/admin/kpi`
* `GET /api/graph/topology`
* `POST /api/tasks/assign`

---

### 3.2 巡检人员 — 我的工作台

#### 功能模块

* **我的待办任务**：展示任务状态（紧急/进行中/待执行）
* **个人绩效看板**：今日、本周完成率统计
* **快捷操作**：异常上报、学习资料、继续任务
* **系统公告**：通知更新与重要提示

#### Arco UI 实现建议

* 使用 `a-tabs` 管理不同任务状态
* 任务表格使用 `ProTable`（分页+搜索+操作列）
* 进度统计用 `a-progress` + `a-statistic-card`
* 公告区使用 `a-timeline` + `a-alert`

#### 关键接口

* `GET /api/tasks/my`
* `POST /api/alerts/report`
* `GET /api/announcement/list`

---

### 3.3 只读用户 — 运营状态总览

#### 功能模块

* **关键运行指标**：设备总数、正常率、巡检完成率
* **设备状态分布**：饼图展示设备健康情况
* **告警级别统计**：按紧急程度统计告警数量
* **实时告警列表**：动态显示最新告警
* **分析报告入口**：跳转至报表分析页面

#### Arco UI 实现建议

* 使用 `a-card-grid` 构建指标卡布局
* 图表采用 `echarts-for-vue` 封装组件
* 告警列表采用 `ProTable` + 动态标色
* 分析报告入口使用 `a-button` + `router-link`

---

## 4. 知识图谱模块设计（Neo4j）

详见前版内容（节点、关系、属性一致），此处仅补充前端展示部分。

### 4.1 前端图谱可视化交互

组件：`GraphCanvas.vue`

* 使用 `Cytoscape.js` / `D3.js` 渲染
* 支持缩放、平移、全屏
* 点击节点显示设备详情（右侧抽屉 `a-drawer`）
* 支持“按类型筛选”与“自动布局”

### 4.2 后端数据结构

与原版一致（Station / Device / Task / Alert / Person / Document 等）

---

## 5. 数据库设计（MySQL）

> 数据结构保持不变（用户表、设备表、任务表、告警表），详见上一版 SQL 定义。

---

## 6. 接口设计（REST + WebSocket）

### 接口风格规范

所有响应统一格式：

```json
{
  "code": 0,
  "message": "ok",
  "data": {}
}
```

Arco 前端在 `src/api/request.ts` 中配置 Axios 拦截器统一处理错误码与登录态。

### WebSocket 推送

* 事件类型：

  * `alert:new`
  * `task:assigned`
  * `system:status`
* 由 Arco Notification 组件实时弹出消息：

  ```js
  Notification.info({
    title: '新告警',
    content: `${alert.deviceName}：${alert.level}`
  })
  ```

---

## 7. 权限与安全设计

### 7.1 前端 RBAC 方案（Arco 路由）

* 路由配置在 `src/router/routes.ts`：

  ```ts
  {
    path: '/admin',
    meta: { role: ['ADMIN'] },
    component: () => import('@/views/admin/Dashboard.vue')
  }
  ```
* 使用全局路由守卫判断用户角色并重定向至对应首页。

### 7.2 安全策略

* Token 存储于 `localStorage` 或 Cookie（HttpOnly）
* 所有 API 调用携带 Bearer Token
* 接口防止越权访问（前后端双层校验）

---

## 8. 前端实现（Vue3 + Arco Design Pro）

### 8.1 目录结构建议

```
src/
 ├─ api/             # Axios 封装与接口定义
 ├─ assets/          # 静态资源
 ├─ components/      # 公共组件
 ├─ layouts/         # 基础布局（Arco Layout）
 ├─ router/          # 路由与权限配置
 ├─ store/           # Pinia 状态管理
 ├─ views/
 │   ├─ admin/       # 管理员首页
 │   ├─ inspector/   # 巡检员首页
 │   ├─ viewer/      # 只读用户首页
 │   ├─ graph/       # 图谱视图
 │   └─ login/       # 登录页
 └─ utils/           # 工具与权限方法
```

### 8.2 布局方案

使用 Arco Design Pro 默认布局：

* `a-layout` + `a-layout-sider` + `a-layout-content`
* 顶栏含角色切换、主题切换、消息中心
* 支持暗色模式（Dark Mode）

### 8.3 组件与交互规范

| 模块     | 推荐组件                       | 用途      |
| ------ | -------------------------- | ------- |
| KPI 面板 | `StatisticCard`            | 数值统计    |
| 告警通知   | `Notification` + `Message` | 实时消息    |
| 数据表格   | `ProTable`                 | CRUD 表格 |
| 表单操作   | `ModalForm`                | 弹窗表单    |
| 图谱区域   | 自定义组件 + ECharts/Cytoscape  | 可视化展示   |
| 抽屉详情   | `a-drawer`                 | 详情页     |

### 8.4 主题与国际化

* 使用 Arco ConfigProvider 配置主题色
* 国际化：`@arco-design/web-vue/es/locale/lang/zh-cn`
* 支持中英切换（可通过 Pinia store 管理）

---

## 9. 后端实现（Node.js + Java）

> 架构保持不变。Node.js 作为 API Gateway / WebSocket 服务层，Java 作为核心业务服务。

---

---

